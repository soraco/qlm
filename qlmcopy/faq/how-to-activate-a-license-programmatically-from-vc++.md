# How to activate a license programmatically from VC++

Following is a code excerpt that shows how to activate a license programmatically from VC++.

The code below assumes that you have an instance of a LicenseValidator class (generated by the Protect Your Application wizard). m\_lv refers to the instance of the LicenseValidator class. In this example, we will bind the license to the computer name.

CComBSTR bstrResponse;

m\_lv->license->ActivateLicense(\_bstr\_t("[https://qlm3.net/qlmdemo/qlmLicenseServer/qlmservice.asmx](https://qlm3.net/qlmdemo/qlmLicenseServer/qlmservice.asmx)"),\
\_bstr\_t("AFGQ0-E0400-G7JBI-Z86H4-1B1W7K"), m\_lv->hardware->GetMachineName(), m\_lv->hardware->GetMachineName(), \_bstr\_t("5.0.00"),\
\_bstr\_t("user data1"), \&bstrResponse);

\
CComBSTR bstrMessage;\
if (m\_lv->license->ParseResultsEx (\_bstr\_t(bstrResponse), m\_lv->licenseInfo, \&bstrMessage))\
{\
&#x20;   CString pckey = m\_lv->licenseInfo->ComputerKey;

&#x20;   MessageBox (QlmLicenseWizardDlg::s\_hwndDialog, (LPCWSTR) (m\_lv->licenseInfo->ComputerKey), \_T("QlmLicenseWizard"), MB\_OK);\
}\
else\
{\
&#x20;   MessageBox(QlmLicenseWizardDlg::s\_hwndDialog, CString(bstrMessage), \_T("QlmLicenseWizard"), MB\_OK);\
}
