# Online Activation using the QLM License Wizard Standalone Application

QLM provides a standalone application (QlmLicenseWizard.exe) that you can invoke from your application to simplify the process of online activation. When using QlmLicenseWizard.exe, there is almost no need to write any code to implement online activation. This method is ideal for non-.NET applications that cannot use the QLM .NET User Control. Samples are provided for C++, MS-Access, Excel and others.

The QLM License Wizard allows your users to:

* View the status of their license.
* View the Check for Updates information and launch the installation of an update.
* Activate a license online.
* Activate a license offline (manual activation and activation via a QR Code).
* Deactivate a license.
* Display a User Registration page that can automatically generate a trial license.
* Display an EULA page.
* Display a Privacy Policy page.
* and much more

The QlmLicenseWizard.exe can be used on any Windows 7 and higher system and requires that Microsoft .NET 4.62 or later be installed on the end-user system.

To use the QlmLicenseWizard.exe application:

* From the QLM Console, create a product.
* Go to the **Protect your application** tab and follow the instructions in the wizard.
* Modify your application as follows:
  * When your application is launched, call the _ValidateLicenseAtStartup_ function. This function is generated by the **Protect your application** wizard in the _LicenseValidator_ class.
  * If the ValidateLicenseAtStartup function returns false, launch the QlmLicenseWizard.exe with the /settings argument.
  * When the QlmLicenseWizard.exe process exits, call _ValidateLicenseAtStartup_ again to ensure that the license is valid.

Once the user has activated his license from the QlmLicenseWizard process, the license key is automatically stored in a hidden location on the end-user system.

_Example_

{% code overflow="wrap" %}
```csharp
LicenseValidator lv = new LicenseValidator ();
if (lv.ValidateLicenseAtStartup(computerID, ref needsActivation, ref returnMsg) == false)
{
    // Launch the QlmLicenseWizard.exe process.
   string settingsFiles = "Demo 1.0.lw.xml"; // you must specify the full path to the settings file
   string args = String.Format("/settings \"{0}\"", settingsFile);

    lv.QlmLicenseObject.LaunchProcess(@"C:\Program Files\Soraco\QuickLicenseMgr\QlmLicenseWizard.exe", args, true, true);
    if (lv.ValidateLicenseAtStartup(computerID, ref needsActivation, ref returnMsg) == false)
    {
        // Exit the application
    }
}
```
{% endcode %}

The command-line arguments of QlmLicenseWizard.exe are:

&#x20;

| **Argument**                              | **Description**                                                                                                                                                                                                                                                                              |
| ----------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| /settings "\<full path to settings file>" | Path to the settings file generated by the **Protect your application** wizard (enclose the full path in double-quotes). _This argument is required._                                                                                                                                        |
| /uiSettings                               | Path to the UI settings file generated by the **Protect your application. Not required as of QLM v9.**                                                                                                                                                                                       |
| /computerID \<computer identifier>        | Optional argument. The unique identifier of the current system. If not argument is provided, the computerID is dynamically computed based on the QlmLicenseBinding property in the XML settings file. _If your license binding is configured to be User Defined, this argument is required._ |
| /activationKey \<activation key>          | <p>Optional argument. By default, the activation key is automatically retrieved from the location associated with your products by calling the ReadKeys API.<br>To override this behaviour, you can specify the activationKey on the command line.</p>                                       |
| /computerKey \<computer key>              | <p>Optional argument. By default, the computer key is automatically retrieved from the location associated with your products by calling the ReadKeys API.<br>To override this behaviour, you can specify the computerKey on the command line.</p>                                           |
| /floating\_master                         | Optional argument. Displays the floating license page when activating the master node.                                                                                                                                                                                                       |
| /floating\_node                           | Optional argument. Displays the floating license page when activating a client node.                                                                                                                                                                                                         |
| /appversion \<version>                    | Optional argument. Sets the version of the application that's launching the wizard. This version is used in the Check for Updates feature.                                                                                                                                                   |
| /showur <0 \| 1>                          | Optional argument. Displays the User Registration page.                                                                                                                                                                                                                                      |
| /showprivacy <0 \| 1>                     | Optional argument. Displays the Privacy Policy page only.                                                                                                                                                                                                                                    |
| /locale \<country\_code>                  | Optional argument. Examples of country codes: fr, en, de, es, it, jp, etc.                                                                                                                                                                                                                   |
| /simulateDate                             | Optional argument. Simulates a date for testing purposes. The expected format of the date is: yyyy-MM-dd                                                                                                                                                                                     |
| /simulateNoConnectivity                   | Optional argument. Simulates no internet connectivity.                                                                                                                                                                                                                                       |
| /topmost                                  | Optional argument. Displays the wizard on top of all other windows                                                                                                                                                                                                                           |
| /left \<x>                                | Optional argument. Left position of the wizard.                                                                                                                                                                                                                                              |
| /top \<y>                                 | Optional argument. Top position of the wizard.                                                                                                                                                                                                                                               |

&#x20;

Upon exiting, the QlmLicenseWizard.exe process returns the following exit codes:

&#x20;

<table data-header-hidden><thead><tr><th width="209"></th><th></th></tr></thead><tbody><tr><td><strong>Exit Code</strong></td><td><strong>Description</strong></td></tr><tr><td> 0</td><td>The license is valid</td></tr><tr><td> 1</td><td>The license is not valid</td></tr><tr><td> 2</td><td>The license has expired</td></tr><tr><td> 3</td><td>Usage error in the command line, typically indicating some missing or invalid arguments</td></tr><tr><td> 4</td><td>The user cancelled the wizard</td></tr><tr><td> 5</td><td>The user downloaded an update and launched the setup.</td></tr><tr><td>10</td><td>The deactivation of the license was successful. QLM v9 and later.</td></tr><tr><td>11</td><td>Deactivation of the license failed. QLM v9 and later.</td></tr><tr><td>12</td><td>The user did not consent to the privacy policy.</td></tr><tr><td>14</td><td>The floating database registration succeeded (as of v11.0.18144.1)</td></tr><tr><td>15</td><td>The floating database registration failed (as of v11.0.18144.1)</td></tr></tbody></table>
