# QLM and Windows Azure Integration (v10)

**\[This article applies to QLM v11 and earlier. if you are using QLM v12, refer to this** [**article**](https://support.soraco.co/hc/en-us/articles/360024356392-QLM-v12-Azure-Integration) **instead.]**

You can host the QLM License Server on a Windows Azure portal. The procedure outlined in this section will show you how to build a QLM Azure deployment package, how to create the database on the Azure Portal and finally how to connect QLM to the Azure hosted QLM License Server.

### 1. Database Creation

To create the QLM database on the Azure portal:

| <table data-header-hidden><thead><tr><th></th></tr></thead><tbody><tr><td><ul><li>Go to the Windows Azure Portal.</li></ul></td></tr><tr><td><ul><li>Select <strong>SQL Databases.</strong></li></ul></td></tr><tr><td><ul><li>Click on the <strong>Add.</strong></li></ul></td></tr><tr><td><ul><li>Set the database name to: <strong>qlm</strong></li></ul></td></tr><tr><td><ul><li>Pick the Subscription, and Resource Group server of your choice.</li></ul></td></tr><tr><td><ul><li>Set the <strong>Select Source</strong> field to "Blank database"</li></ul></td></tr><tr><td><ul><li>Select an existing Server or create a New Server</li></ul></td></tr><tr><td><ul><li>Select whether you want to use a SQL Elastic pool</li></ul></td></tr><tr><td><ul><li>Select a Pricing tier</li></ul></td></tr><tr><td><ul><li>Use the default Collation</li></ul></td></tr><tr><td><ul><li>Click <strong>Create</strong></li></ul></td></tr></tbody></table> | ![](https://support.soraco.co/hc/article\_attachments/115010838106/mceclip0.png) |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| <ul><li>Go to the Windows Azure Portal.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                  |
| <ul><li>Select <strong>SQL Databases.</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                  |
| <ul><li>Click on the <strong>Add.</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                  |
| <ul><li>Set the database name to: <strong>qlm</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                  |
| <ul><li>Pick the Subscription, and Resource Group server of your choice.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                  |
| <ul><li>Set the <strong>Select Source</strong> field to "Blank database"</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                  |
| <ul><li>Select an existing Server or create a New Server</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                  |
| <ul><li>Select whether you want to use a SQL Elastic pool</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                  |
| <ul><li>Select a Pricing tier</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                  |
| <ul><li>Use the default Collation</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                  |
| <ul><li>Click <strong>Create</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                  |

### 2. Server settings

If you selected to create a new SQL database server on the previous step, you need to configure a user account on the SQL Server.

| <table data-header-hidden><thead><tr><th></th></tr></thead><tbody><tr><td><ul><li>In the Server name field, enter a name of your choice. Example: qlm-server</li></ul></td></tr><tr><td><ul><li>In the Server admin login field, enter a name of your choice. Example: qlm_admin</li></ul></td></tr><tr><td><ul><li>In the password and confirm password fields, enter a new password</li></ul></td></tr><tr><td><ul><li>Select a Location</li></ul></td></tr><tr><td><ul><li>Click Select</li></ul></td></tr><tr><td> </td></tr></tbody></table> | ![](https://support.soraco.co/hc/article\_attachments/115011033463/mceclip1.png) |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| <ul><li>In the Server name field, enter a name of your choice. Example: qlm-server</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                  |
| <ul><li>In the Server admin login field, enter a name of your choice. Example: qlm_admin</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                  |
| <ul><li>In the password and confirm password fields, enter a new password</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                  |
| <ul><li>Select a Location</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                  |
| <ul><li>Click Select</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                  |

### 3. Configure the database

Now that the database is created, we need to create the tables and stored procedures. Follow the steps below:

| <table data-header-hidden><thead><tr><th></th></tr></thead><tbody><tr><td><ul><li>Click on the QLM database in the list</li><li>Click Tools</li><li>Click Query Editor</li><li>Click login and enter your credentials</li><li>Click Open Query and select: %Public%\Documents\Quick License Manager\DeployToAzure\Db\qlm.createtables.sql</li><li>Click on Run to execute the query</li><li>Repeat these two steps for the following files, in the exact order listed here: InstallCommon.sql, InstallRoles.sql, InstallPersonalization.sql, InstallProfile.sql, InstallMembership.sql</li></ul></td></tr></tbody></table> | ![](https://support.soraco.co/hc/article\_attachments/115010843066/mceclip2.png) |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| <ul><li>Click on the QLM database in the list</li><li>Click Tools</li><li>Click Query Editor</li><li>Click login and enter your credentials</li><li>Click Open Query and select: %Public%\Documents\Quick License Manager\DeployToAzure\Db\qlm.createtables.sql</li><li>Click on Run to execute the query</li><li>Repeat these two steps for the following files, in the exact order listed here: InstallCommon.sql, InstallRoles.sql, InstallPersonalization.sql, InstallProfile.sql, InstallMembership.sql</li></ul>                                                                                                     |                                                                                  |

### 4. Creating the QLM package

To deploy the QLM License Server to Windows Azure, you must create an Azure package by following the steps oultined below:

| <table data-header-hidden><thead><tr><th></th></tr></thead><tbody><tr><td><ul><li>Launch the QLM Management Console and go to the Manage Keys tab</li></ul></td></tr><tr><td><ul><li>Click on the Sites button in the toolbar, then click on Add</li></ul></td></tr><tr><td><ul><li>Enter a name for your Azure site, say QlmAzure, and click OK.</li></ul></td></tr><tr><td><ul><li>In the Primary Site field, enter (you can replace 'myqlm' with any value of your choice): http://myqlm.cloudapp.net/qlmlicenseserver/QlmService.asmx</li></ul></td></tr><tr><td><ul><li>If you replaced 'myqlm' with any other value, note that you will need to use the same value later on in this procedure.</li></ul></td></tr><tr><td><ul><li>Set the Database Engine to: SQL Server</li></ul></td></tr><tr><td><ul><li>Click on the Encryption Keys tab, then click New for both fields to generate a CommunicationEncryptionKey and an AdminEncryptionKey</li></ul></td></tr><tr><td><ul><li>Click on the Database Connection tab and enter all the fields on this tab</li></ul></td></tr><tr><td><ul><li>Server Hostname or IP: to get this value, select your database in Azure, and click on the Overview tab.</li><li>Click Show database connection strings</li><li>In the ADO.NET tab, copy the value of the Server entry. The value typically looks like: tcp:qlm-server.database.windows.net,1433</li></ul></td></tr><tr><td><ul><li>Database Name: qlm or any other name you have entered earlier in the process</li></ul></td></tr><tr><td><ul><li>User Name: name of the sql admin user you specified earlier in the process</li></ul></td></tr><tr><td><ul><li>User Password: password of the sql admin user you specified earlier in the process</li></ul></td></tr><tr><td><ul><li>Click on Update config files</li></ul></td></tr><tr><td><ul><li>Do not click OK -- leave the Sites editor open.</li></ul></td></tr></tbody></table><table data-header-hidden><thead><tr><th></th></tr></thead><tbody><tr><td><ul><li>The next steps involve building the package using Visual Studio 2017/2015. You will need to first install the <a href="https://azure.microsoft.com/en-ca/downloads/">Azure SDK for .NET</a>.</li></ul></td></tr><tr><td><ul><li>Open and Build the QlmAzure solution located in the %Public%\Documents\Quick License Manager\DeployToAzure\ folder using Visual Studio 2017/2015</li></ul></td></tr><tr><td><ul><li>Right mouse click on the QlmAzure project and select "Package"</li></ul></td></tr><tr><td><ul><li>Set the Service Configuration to <strong>Cloud</strong> and Build Configuration to <strong>Release</strong> then click on Package</li></ul></td></tr><tr><td><ul><li>The following 2 files will be created in the QlmAzure\QlmAzure\bin\Release\app.publish folder: QlmAzure.cspkg and ServiceConfiguration.Cloud.cscfg files</li></ul></td></tr></tbody></table> | ![](https://support.soraco.co/hc/article\_attachments/115010843366/mceclip3.png)![](https://support.soraco.co/hc/article\_attachments/115010843346/mceclip2.png) |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <ul><li>Launch the QLM Management Console and go to the Manage Keys tab</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                  |
| <ul><li>Click on the Sites button in the toolbar, then click on Add</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                  |
| <ul><li>Enter a name for your Azure site, say QlmAzure, and click OK.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                  |
| <ul><li>In the Primary Site field, enter (you can replace 'myqlm' with any value of your choice): http://myqlm.cloudapp.net/qlmlicenseserver/QlmService.asmx</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                  |
| <ul><li>If you replaced 'myqlm' with any other value, note that you will need to use the same value later on in this procedure.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                  |
| <ul><li>Set the Database Engine to: SQL Server</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                  |
| <ul><li>Click on the Encryption Keys tab, then click New for both fields to generate a CommunicationEncryptionKey and an AdminEncryptionKey</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                  |
| <ul><li>Click on the Database Connection tab and enter all the fields on this tab</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                  |
| <ul><li>Server Hostname or IP: to get this value, select your database in Azure, and click on the Overview tab.</li><li>Click Show database connection strings</li><li>In the ADO.NET tab, copy the value of the Server entry. The value typically looks like: tcp:qlm-server.database.windows.net,1433</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                  |
| <ul><li>Database Name: qlm or any other name you have entered earlier in the process</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                  |
| <ul><li>User Name: name of the sql admin user you specified earlier in the process</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                  |
| <ul><li>User Password: password of the sql admin user you specified earlier in the process</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                  |
| <ul><li>Click on Update config files</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                  |
| <ul><li>Do not click OK -- leave the Sites editor open.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                  |
| <ul><li>The next steps involve building the package using Visual Studio 2017/2015. You will need to first install the <a href="https://azure.microsoft.com/en-ca/downloads/">Azure SDK for .NET</a>.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                  |
| <ul><li>Open and Build the QlmAzure solution located in the %Public%\Documents\Quick License Manager\DeployToAzure\ folder using Visual Studio 2017/2015</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                  |
| <ul><li>Right mouse click on the QlmAzure project and select "Package"</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                  |
| <ul><li>Set the Service Configuration to <strong>Cloud</strong> and Build Configuration to <strong>Release</strong> then click on Package</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                  |
| <ul><li>The following 2 files will be created in the QlmAzure\QlmAzure\bin\Release\app.publish folder: QlmAzure.cspkg and ServiceConfiguration.Cloud.cscfg files</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                  |

### 5. Cloud Service

To deploy the QLM Cloud Service to the Azure portal:

| <table data-header-hidden><thead><tr><th></th></tr></thead><tbody><tr><td><ul><li>Go to the Windows Azure Portal.</li></ul></td></tr><tr><td><ul><li>Select <strong>Cloud Services (classic)</strong></li></ul></td></tr><tr><td><ul><li>Click <strong>Add</strong>.</li></ul></td></tr><tr><td><ul><li>Set the DNS name to any value of your choice that matches the value you set earlier on Sites page: <strong>myqlm</strong></li></ul></td></tr><tr><td><ul><li>Set the Subscription, Resource Group and Location  to any value of your choice.</li></ul></td></tr><tr><td><ul><li>Click on <strong>Package / Select a Package.</strong></li></ul></td></tr><tr><td><ul><li>Enter a Deployment label of your choice</li></ul></td></tr><tr><td><ul><li>Set the Package/configuration location to <strong>from local.</strong></li></ul></td></tr><tr><td><ul><li>Select a Storage account</li></ul></td></tr><tr><td><ul><li>In the Package (.cspkg) field, select the file QlmAzure.cspkg that was generated earlier from the Visual Studio solution.</li></ul></td></tr><tr><td><ul><li>In the Configuration (.cscfg) field, select the file ServiceConfiguration.Cloud.cscfg that was generated earlier from the Visual Studio solution.</li></ul></td></tr><tr><td><ul><li>Select the Environment  of your choice</li></ul></td></tr><tr><td><ul><li>Check <strong>Start deployment</strong>.</li></ul></td></tr><tr><td><ul><li>Click <strong>OK.</strong></li></ul></td></tr><tr><td><ul><li>Click <strong>Create.</strong></li></ul></td></tr></tbody></table> | ![](https://support.soraco.co/hc/article\_attachments/115010890426/mceclip0.png)   |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- |
| <ul><li>Go to the Windows Azure Portal.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                    |
| <ul><li>Select <strong>Cloud Services (classic)</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                    |
| <ul><li>Click <strong>Add</strong>.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                    |
| <ul><li>Set the DNS name to any value of your choice that matches the value you set earlier on Sites page: <strong>myqlm</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                    |
| <ul><li>Set the Subscription, Resource Group and Location  to any value of your choice.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                    |
| <ul><li>Click on <strong>Package / Select a Package.</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                    |
| <ul><li>Enter a Deployment label of your choice</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                    |
| <ul><li>Set the Package/configuration location to <strong>from local.</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                    |
| <ul><li>Select a Storage account</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                    |
| <ul><li>In the Package (.cspkg) field, select the file QlmAzure.cspkg that was generated earlier from the Visual Studio solution.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                    |
| <ul><li>In the Configuration (.cscfg) field, select the file ServiceConfiguration.Cloud.cscfg that was generated earlier from the Visual Studio solution.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                    |
| <ul><li>Select the Environment  of your choice</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                    |
| <ul><li>Check <strong>Start deployment</strong>.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                    |
| <ul><li>Click <strong>OK.</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                    |
| <ul><li>Click <strong>Create.</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                    |
| <table data-header-hidden><thead><tr><th></th></tr></thead><tbody><tr><td><ul><li>Once the package is created, click on service that was created and go to the OverView tab. Take note of the <strong>Site Url</strong></li></ul></td></tr><tr><td><ul><li>Now go back to the QLM Management Console, Manage Keys / Sites which you left open earlier.</li></ul></td></tr><tr><td><ul><li>On the General tab, set the Primary Site to: &#x3C;siteUrl>/qlmlicenseserver/qlmservice.asmx</li></ul></td></tr><tr><td><ul><li>Click the <strong>Test</strong> button next to the primary site URL and confirm that all tests have passed.</li></ul></td></tr></tbody></table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | ![](https://support.soraco.co/hc/en-us/article\_attachments/207883383/Azure12.png) |
| <ul><li>Once the package is created, click on service that was created and go to the OverView tab. Take note of the <strong>Site Url</strong></li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                    |
| <ul><li>Now go back to the QLM Management Console, Manage Keys / Sites which you left open earlier.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                    |
| <ul><li>On the General tab, set the Primary Site to: &#x3C;siteUrl>/qlmlicenseserver/qlmservice.asmx</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                    |
| <ul><li>Click the <strong>Test</strong> button next to the primary site URL and confirm that all tests have passed.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                    |

This completes the configuration of the Azure site.

&#x20;

**How to upgrade an existing Azure deployment with a new version of QLM**

* Install the new version of QLM on your system
* Go to the Manage Keys tab
* Click Sites and select your site
* Go to the Database Connection tab
* Confirm that all the settings are correct
* Click **Update config files**
* Open the QlmAzure solution located in the %Public%\Documents\Quick License Manager\DeployToAzure\ folder using Visual Studio 2017/2015
* Build the solution in Release mode.
* Right mouse click on the QlmAzure project and select "Package"
* Set the Service Configuration to **Cloud** and Build Configuration to **Release** then click on Package
* The following 2 files will be created in the QlmAzure\QlmAzure\bin\Release\app.publish folder: QlmAzure.cspkg and ServiceConfiguration.Cloud.cscfg files
* In the Azure portal, select the cloud service to update
* Click **Update**
* Set a deployment label
* Select "from local"
* Select a storage account
* Set the package and configuration fields to the files created above.
* Select "Deploy even if one or more roles contain a single instance"
* Click Ok

#### Troubleshooting

You may get the following error when connecting to the QLM License Server:

_Cannot open server 'xxx' requested by the login. Client with IP address 'yyy' is not allowed to access the server. To enable access, use the Windows Azure Management Portal or run sp\_set\_firewall on the master database to create a firewall rule for this IP address or address range._

To resolve this error, follow the steps below:

* In the Azure Portal, click SQL databases then click the QLM database
* Locate the Server name field and click on the server link
* Click "Firewalls and virtual networks"
* Create a new rule as follows:
  * Rule 1
  * Start IP: The IP address listed in the error message
  * End IP: The IP address listed in the error message
* Click Save
* Wait a few minutes and then test again
